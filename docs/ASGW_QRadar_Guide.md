---
subtitle: '<span id="h.30j0zll" class="anchor"></span>Version 204010103'
title: '<span id="h.gjdgxs" class="anchor"></span>AdditionSecurity Messaging Gateway Integration with IBM QRadar 7.x'
---

Overview
========

This document contains instructions in configuring the AdditionSecurity Messaging Gateway to forward messages to an IBM QRadar SIEM system.

This guide is written to for IBM QRadar 7.x.

Prerequisites
=============

It is assumed:

-   The reader has administrative & configuration understanding of IBM QRadar

-   The reader has read the AdditionSecurity Messaging Gateway Operations Guide

-   The deployed Messaging Gateway(s) will be co-located or otherwise able to communicate over a network to the QRadar system(s)

Configuration Summary
=====================

This guide will recommend an AdditionSecurity Messaging Gateway to send LEEF-formatted messages over syslog to an IBM QRadar system using the Universal LEEF DSM (Device Support Module).

Configuring IBM QRadar
======================

Configure a Universal LEEF syslog source in QRadar
--------------------------------------------------

1.  Log in to QRadar

2.  Click the Admin tab

3.  On the navigation menu, click Data Sources

4.  Click the Log Sources icon

5.  Click Add

6.  In the Log Sources Name field, type a name for your log source

7.  In the Log Source Description field, type a description for your log source

8.  From the Log Source Type list, select Universal LEEF

9.  Using the Protocol Configuration list, select Syslog

10. In the Log Source Identifier, type the IP address or hostname of the Message Gateway system

11. Click Save

12. On the Admin tab, click Deploy Changes

The Universal LEEF syslog log source has been added to QRadar.

Configuring AdditionSecurity Message Gateway
============================================

The relevant configuration properties from the Message Gateway config.properties file are:
```
port=5000

definitions=definitions.json

input=protobuf

transform=leef

transform.systemId2\_string=true

transform.accountName2\_string=true

transform.include\_title=true

output=udpsyslog

output.syslog.host=(IP address or hostname of QRadar system)

output.syslog.port=514
```
This instructs the gateway to transform messages into the LEEF format, then forward the messages over UDP syslog to the QRadar system.

Test & Categorizing Event Information
=====================================

Once the Message Gateway is deployed and operational, incoming messages will be forwarded to QRadar and displayed in the Log Activity tab in the QRadar console. The events for the gateway forwarding LEEF events is identified by the name you typed in the Log Source Name field. The events for your log source are not categorized by default in QRadar and require categorization.

Categorizing Event Information in QRadar
----------------------------------------

Event mapping is required for the Universal LEEF DSM, as Universal LEEF events do not contain a predefined QRadar Identifier (QID) map to automatically categorize Message Gateway events.

The Universal LEEF DSM requires that you individually map each event for the Message Gateway to an event category in QRadar. Mapping events allows QRadar to identify, coalesce, and track recurring events from the Message Gateway. Until you map an event, all events that are displayed in the Log Activity tab for the Universal LEEF DSM are categorized as ‘Unknown’. Unknown events are easily identified as the Event Name column displays the value ‘Unknown’.

### Finding Recent Unknown/Uncategorized Events

1.  Log into QRadar

2.  Click the Log Activity tab

3.  Click Add Filter

4.  From the first list, select Log Source

5.  From the Log Source Group list, select the log source group or Other; lot source that are not assigned to a group are categorized as Other

6.  From the Log Source list, select your Universal LEEF log source

7.  Click Add Filter; the Log Activity tab is displayed with a filter for your Universal LEEF DSM

8.  From the View list, select Last Hour

Any events generated by the Message Gateway in the last hour are displayed. Events displayed as ‘Unknown’ in the Event Name column require event mapping.

### Manually Categorizing Events

1.  Select an uncategorized/’Unknown’ event

2.  On the Event Name column, double-click the event; the detailed event information is displayed

3.  Click Map Event

4.  From the Browser for QID pane, select a search option (High-Level Category, Low-Level Category, QID/Name, etc.) to narrow the event categories for a QID

5.  Click Search; a list of QIDs are displayed

6.  Select the QID you want to associate with your unknown event

7.  Click OK

Suggested Event Categorizations
===============================

Below is a reference chart of suggested AdditionSecurity event IDs to QRadar Low-Level Event Categories.


  **AdditionSecurity Event (ID - Title)**     | **QRadar Low-Level Event Category**
  -------------------------------------------|----------------------------------------------------------------------
  1 - System Hardware Info                     |Information, or System Status                                               
  2 - System Firmware Info                                                                   
  3 - System OS Info                                                                          
  4 - Application Info                                                                      
  404 - Application Signer                                                                  
  408 - Provisioning Signer                    
  51 - Customer Message                        |Information
  52 - Identity Registration                   |Misc Login Succeeded                                            
  53 - Login Successful                        
  54 - Login Unsuccessful                      |Misc Login Failed
  150 - Known Malware Artifact                 |Unknown Malware, Misc Malware, or                                              
  152 - Known Malware Signer Present           |Virus Detected
  151 - Stolen Cert Signer Present             |Malicious Software, or Warning                                              
  307 - Hacking Tool Installed                                                               
  308 - Security Subversion Tool Installed                                                  
  309 - Application Tampering Tool Installed                                                 
  310 - Game Cheat Tool Installed                                                             
  311 - Fraud Tool Installed                                                                 
  312 - Security Hiding Tool Installed         
  300 - Synthetic System Artifact              |Rogue Device Detected, Compliance Violation, or Warning                                               
  302 - Non-Production System Artifact         
  312 - Test Automation Tool Installed         |Compliance Violation, Information, or System Status                                              
  402 - Application Unencrypted                                                              
  404 - Application Unsigned                   
  313 - Security Expectation Failure           |Unknown Suspicious Event, Misc Suspicious Event, Error, Unknown Potential Exploit Attack, Potential Misc Exploit, or Alert                                            
  400 - Debug/Instrumentation Artifact                                                      
  401 - Application Tampering Detected                                                      
  403 - Application Encryption Disabled                                                      
  406 - Stealth Callback Failure                                                             
  409 - Provisioning Missing                                                                  
  410 - Provisioning Corrupted                                                                
  411 - Security Operation Failed              
  314 - System Rooted/Jailbroken               |Information, Warning, or Misc Suspicious Event
  500 - SSL Pin Violation                      |SSL Session Denied, HTTPS Denied, Invalid Cert, or Web Protocol Anomaly
  501 - MITM Detected                          |Potential Misc Exploit, or Potential Infrastructure Exploit
  
